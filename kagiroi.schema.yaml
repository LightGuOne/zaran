schema:
  schema_id: kagiroi
  name: ã‚«ã‚®ãƒ­ã‚¤
  icon: ico/kagiroi.ico
  version: '20250717'
  author:
    - kuroame
  description: |
    ã‚¹ãƒãƒ¼ãƒˆãªæ—¥æœ¬èªå…¥åŠ›ã€‚
  dependencies:
    - kagiroi_romaji
    - kagiroi_kanji
    - moran_reverse

switches:
  - name: ascii_mode
    reset: 0
    states: [ ã‚, è‹±å­— ]
  - options: [ hiragana, katakana, hw_katakana]
    reset: 0
    # states: [ ã²ã‚‰ãŒãª, ã‚«ã‚¿ã‚«ãƒŠ, ï½¶ï¾€ï½¶ï¾…]
    states: [ å¹³ä»®å, ç‰‡ä»®å, ï½¶ï¾€ï½¶ï¾…]
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
  - name: ascii_punct
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]
  # - name: emoji
  #   states: [ ğŸˆš, ğŸˆ¶ ]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - lua_processor@*kagiroi/kagiroi_kana_speller # convert raw input to hiragana
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - reverse_lookup_translator@moran # for kagiroi # for moran revserse lookup
    - lua_translator@*kagiroi/kagiroi_translator
  filters:
    # - simplifier@emoji
    - lua_filter@*kagiroi/kagiroi_aux_filter
    - uniquifier

speller:
  __include: kagiroi:/alphabet/3_dan_hira
  # use 4_dan_hira if you want to use ansikana or other layout that requires 4 rows of keys
  # __include: kagiroi:/alphabet/4_dan_hira

translator:
  dictionary: kagiroi
  enable_user_dict: true
  enable_sentence: false
  enable_completion: false
  tag: kagiroi

# custom_phrase:
#   dictionary: ""
#   user_dict: kagiroi_custom_phrases
#   db_class: stabledb
#   enable_completion: false
#   enable_sentence: false

punctuator:
  __patch:
    - kagiroi:/punct/3_dan
    # use 4_dan if you want to use ansikana or other layout that requires 4 rows of keys
    # - kagiroi:/punct/4_dan

recognizer:
  import_preset: default
  patterns:
    moran: "^C[a-z]*$"

abc_segmentor:
  extra_tags:
    - kagiroi

editor:
  bindings:
    Return: commit_script_text

key_binder:
  import_preset: default
  bindings:
  #   - { when: has_menu, accept: minus, send: Page_Up }
  #   - { when: has_menu, accept: equal, send: Page_Down }
    __patch:
    #   - kagiroi:/key_bindings/paging_with_minus_equal # comment this line out to free -= for use in 4-dan layouts
      - kagiroi:/key_bindings/kagiroi_switches

# emoji:
#   opencc_config: kagiroi_emoji.json
#   option_name: emoji
#   tips: none

kagiroi_kanji:
  dictionary: kagiroi_kanji

moran:
  dictionary: moran.chars
  target: kagiroi_kanji
  prefix: "C"
  tips: "ã€”é­”ç„¶ã€•"
  tag: moran
  preedit_format:
    - xform/^C//

kagiroi:
  # Choose the input method layout. Whichever layout you select, 
  # you must also add its corresponding schema file to the dependencies list in your schema
  # See kagiroi_xxx.dict.yaml to check the actual definition of the layout
  #é€‰æ‹©è¾“å…¥æ³•å¸ƒå±€ã€‚æ— è®ºæ‚¨é€‰æ‹©å“ªç§å¸ƒå±€ï¼Œ
  #æ‚¨è¿˜å¿…é¡»å°†å…¶ç›¸åº”çš„æ¶æ„æ–‡ä»¶æ·»åŠ åˆ°æ¶æ„ä¸­çš„ä¾èµ–å…³ç³»åˆ—è¡¨ä¸­
  #è¯·å‚é˜…kagiroi_xxx.dict.yamlä»¥æ£€æŸ¥å¸ƒå±€çš„å®é™…å®šä¹‰
  # options:
  #  - romaji:  ä¸å¤§å¤šæ•°æ“ä½œç³»ç»Ÿä¸Šé¢„è£…çš„æ ‡å‡†ç½—é©¬å­—è¾“å…¥ç±»ä¼¼
  #  - romaji:  Similar to the standard Romaji input pre-installed on most operating systems
  #  - szromaji: ä¸€ç§å®šåˆ¶çš„ã€æ‰©å±•çš„ç½—é©¬å­—å¸ƒå±€ã€‚ï¼ˆæ³¨ï¼šç›®å‰å¤„äºæ—©æœŸå¼€å‘é˜¶æ®µï¼‰
  #  - szromaji: A custom, extended Romaji layout. (Note: Currently in early development)
  #  - ansikana: é€‚ç”¨äºæ ‡å‡†ANSIé”®ç›˜çš„å‡åè¾“å…¥ï¼ˆå¦‚æ—¥æœ¬ç‰©ç†é”®ç›˜ï¼‰
  #  - ansikana: Kana input (like a Japanese physical keyboard) adapted for a standard ANSI keyboard
  #    (Note: Kana input will need a 4-dan alphabet/punctuator`)
  #   ï¼ˆæ³¨ï¼šå‡åè¾“å…¥éœ€è¦ä¸€ä¸ª4æ®µå­—æ¯/æ ‡ç‚¹ç¬¦å·`ï¼‰
  layout: romaji
  
  speller:
    __include: kagiroi:/alphabet/3_dan
    # use 4_dan if you want to use ansikana or other layout that requires 4 rows of keys
    # å¦‚æœè¦ä½¿ç”¨ansikanaæˆ–å…¶ä»–éœ€è¦4è¡Œé”®çš„å¸ƒå±€ï¼Œè¯·ä½¿ç”¨4_dan
    # __include: kagiroi:/alphabet/4_dan
  
  translator:
    sentence: 
      # number of sentence candidates
      # å¥å­å€™é€‰æ•°
      size: 2

      # allow table words to participate in sentence formation (only after being committed)
      # å…è®¸è¡¨è¯å‚ä¸å¥å­å½¢æˆï¼ˆä»…åœ¨æäº¤åï¼‰
      allow_table_word: false
    
    # Mapping input during translation, it's a convenient way to tweak input 
    # without affecting the behavior of the kana speller
    # åœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­æ˜ å°„è¾“å…¥ï¼Œè¿™æ˜¯ä¸€ç§è°ƒæ•´è¾“å…¥çš„æ–¹ä¾¿æ–¹æ³•
    # ä¸å½±å“å‡åæ‹¼å†™è€…çš„è¡Œä¸º
    input_mapping:
      # Explain trailing n as ã‚“, this is useful when using romaji layout
      # since you can avoid typing n twice to get ã‚“
      # å°†å°¾éšnè§£é‡Šä¸ºã‚“,è¿™åœ¨ä½¿ç”¨romajiå¸ƒå±€æ—¶å¾ˆæœ‰ç”¨
      # å› ä¸ºä½ å¯ä»¥é¿å…è¾“å…¥nä¸¤æ¬¡æ¥è·å¾—ã‚“
      - xform/^([^`]*)n$/$1ã‚“$/
      # for szromaji users
      # é€‚ç”¨äºszromajiç”¨æˆ·
      # - xform/^(.*)a$/$1ã‚$/
      # - xform/^(.*)i$/$1ã„$/
      # - xform/^(.*)u$/$1ã†$/
      # - xform/^(.*)e$/$1ãˆ$/
      # - xform/^(.*)o$/$1ãŠ$/

  # Gikun (ç¾©è¨“) is a powerful feature for personalizing your dictionary.
  # å¯¹äºszromajiç”¨æˆ·æ¥è¯´ï¼Œ#Gikunï¼ˆç¾©è¨“ï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä¸ªæ€§åŒ–è¯å…¸åŠŸèƒ½ã€‚
  # It allows you to associate a non-standard reading (what you type) with a specific word or phrase (the result)
  # å®ƒå…è®¸æ‚¨å°†éæ ‡å‡†é˜…è¯»ï¼ˆæ‚¨é”®å…¥çš„å†…å®¹ï¼‰ä¸ç‰¹å®šå•è¯æˆ–çŸ­è¯­ï¼ˆç»“æœï¼‰ç›¸å…³è”
  # For example: The word "æœªæ¥" (standard reading: ã¿ã‚‰ã„), with Gikun, you could create
  # ä¾‹å¦‚ï¼šå•è¯â€œæœªæ¥â€ï¼ˆæ ‡å‡†é˜…è¯»ï¼šã¿ã‚‰ã„),ä½¿ç”¨Gikunï¼Œæ‚¨å¯ä»¥åˆ›å»º
  # a custom entry like "ã‚ã™;æœªæ¥" to make rime suggest "æœªæ¥" when you type "ã‚ã™"
  # ä¸€ä¸ªè‡ªå®šä¹‰æ¡ç›®ï¼Œå¦‚â€œæ˜å¤©ï¼›æœªæ¥â€ï¼Œå½“ä½ é”®å…¥â€œæ˜å¤©â€æ—¶ï¼Œrimeä¼šæç¤ºâ€œæœªæ¥â€
  gikun:
    # Enable or disable the Gikun feature
    # å¯ç”¨æˆ–ç¦ç”¨GikunåŠŸèƒ½
    enable: true
    # The delimiter to separate the reading and the text of the word
    # åˆ†éš”å•è¯é˜…è¯»å’Œæ–‡æœ¬çš„åˆ†éš”ç¬¦
    # Note: This character must also be added to your `speller/alphabet` to be recognized by the speller
    # æ³¨æ„ï¼šæ­¤å­—ç¬¦ä¹Ÿå¿…é¡»æ·»åŠ åˆ°æ‚¨çš„â€œæ‹¼å†™å™¨/å­—æ¯è¡¨â€ä¸­æ‰èƒ½è¢«æ‹¼å†™å™¨è¯†åˆ«
    delimiter: ";"